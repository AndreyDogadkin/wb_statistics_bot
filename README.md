# WB Statistics Telegram Bot
___
## Описание:
Телеграм бот создан для быстрого взаимодействия с WB API.

В мобильном приложении WB Partners не реализован функционал просмотра продаж по артикулам.
Бот закрывает потребность пользователей получать более точные данные о своих продажах через мобильное
устройство.

### Функционал:
⚠️ Проект находится в разработке.
- [x] Мультиаккаунт
  - [x] Добавление аккаунтов
  - [x] Редактирование аккаунтов
  - [x] Удаление аккаунтов
- [x] Сохранение токенов WB API
  - [x] Хранение организовано в зашифрованном виде по стандарту AES.
  - [x] Обновление токенов
- [x] Получение статистики
  - [x] Получение статистики артикула при выборе предустановленных периодов
  - [ ] Получение статистики при выборе произвольного периода
  - [ ] Получение статистики по нескольким артикулам за 1 запрос
- [x] Избранные запросы
  - [x] Добавление запроса в избранное
  - [x] Удаление запроса из избранного
- [x] Лимиты запросов
  - [x] Просмотр лимитов запросов
  - [x] Обновление лимитов запросов
- [ ] Дополнительные функции.
  - [ ] Получение остатков товаров на складах
  - [ ] Получение продаж с подробным описанием

___
## Быстрый старт:
⚠️ Для полноценной работы бота необходим аккаунт WB Partners.

Последовательно выполните команды:
```
git clone https://github.com/AndreyDogadkin/wb_statistics_bot.git
```
```
cd wb_statistics_bot
```
Создайте файл .env и заполните его по примеру env.example
```
USE_PROXY=False

# Телеграм
TG_TOKEN=  # str Телеграм токен.
TG_TOKEN_SUPPORT=  # str -- Телеграм токен бота для отправки Админу сообщений о проблеммах
SUPPORT_ID=  # int -- id чата для получения сообщений о проблемах
ADMINS=  # list -- Список администраторов бота через запятую.
PROXY=  # srt -- Прокси сервер

# Шифрование токенов
PASSWORD_FOR_ENCRYPTION=  # str -- Пароль для генерации ключа шифрования.
DKLEN=  # int -- Длина ключа шифрования.
ENCRYPTION_KEY= # bytes -- Ключ шифрования(сгенерировать через utils/generate_encryption_key.py)

# БД
DB_PROD= # bool -- Если False то используется SQLite
DB_HOST= # str -- Хост базы данных
DB_PORT= # int -- Порт базы занных
DB_USER= # str -- Имя пользователя
DB_PASSWORD=  # str -- Пароль базы данных.
DB_NAME= # str -- Имя базы данных

# Webhook
USE_WEBHOOK= # bool -- True если используете webhook
WEBHOOK_BASE_URL= # str -- Например: https://xxx.ngrok-free.app
WEBHOOK_PATH= # str -- Например: /bot/
WEBHOOK_SECRET= # str -- Ваш секретный ключ(Придумываете/генерируете сами)
WEBHOOK_HOST= # str -- Например: http://127.0.0.1
WEBHOOK_PORT= # str -- Например: 8000
```
* Для генерации ключа шифрования, находясь в корневой директории проекта, выполните команду:
```
python bot/utils/aes_encryption/generate_encryption_key.py 
```
После заполнения, находясь в корневой директории проекта, выполните команды:
```
python3.11 -m venv venv
source venv/bin/activate
alembic upgrade head
python -m bot
```
___
Зависимости:
* Python3.11
* aiogram3
* aiohttp
* fastapi
* pydantic
* pydantic-settings
* SQLAlchemy
* alembic
